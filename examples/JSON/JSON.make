# This Makefile is generated by lrgen.
# lrgen will NOT overwrite this Makefile.
#
#
# This Makefile will build the 'JSON' parser sample program.
#
#
# When using a development tree, invoke like this:
#
#  make \
#     LRSTAR_INSTALL_ROOT=${LRSTAR_BUILD_DIR}/${LRSTAR_BUILD_TYPE}/usr/local \
#     -f <directory of grammar>/JSON.make
#
#
# When using lrstar installed in /usr/local, invoke like this:
#
#  make \
#     -f <directory of grammar>/JSON.make
#
#
# The resultant executable, having the 'basename' of the grammar,
# will be placed into a subdirectory of:
#
#  ${LRSTAR_BUILD_DIR}/${LRSTAR_BUILD_TYPE}
#
GRM		:= JSON
.DEFAULT_GOAL	:= recurse	# In sample.defs


# A development environment has files in $(LRSTAR_INSTALL_ROOT), post build.
# For a non-development environment, files should be installed in /usr/local.
#
INSTALL_ROOT	:=			\
	$(if $(LRSTAR_INSTALL_ROOT),$(LRSTAR_INSTALL_ROOT),/usr/local)


include $(INSTALL_ROOT)/make/sample.defs

GRMOPT	:= ast astp=3 d
LGROPT	:=


SOURCE	:=			\
	$(GRM)_Lexer.cpp	\
	$(GRM)_Main.cpp		\
	$(GRM)_Parser.cpp	\
	$(GRM)_user.cpp		\
	$(GRM)_user_main.cpp


OBJS	:=				\
	$(SOURCE:.cpp=.o)		\
	$(INSTALL_ROOT)/lib/lrstar.a


$(GRM).sentinel:	$(GRM).grm $(GRM).lgr JSON.make
	if $(LRGEN)			\
	  --directory $(GRM_DIR)	\
	  --grm $(GRM)			\
	  --grmopt "$(GRMOPT)"		\
	  --lgropt "$(LGROPT)"; then	\
	    touch $@;			\
	else				\
	    false;			\
	fi;


$(OBJS):	$(GRM).sentinel


$(GRM):	$(OBJS)
	$(CC) $(CXXFLAGS) -o $@ $(OBJS);


clean:
	rm $(OBJS) $(GRM);

-include $(SOURCE:.cpp=.d)
